# KaamyabPakistan Migration Work Record

## Date: December 12, 2025

---

## Summary

Successfully migrated KaamyabPakistan project data from old GCP project (`molten-optics-310919`) to new project (`aialgotradehits`). All 512 projects are now loaded in BigQuery. Old source code has been extracted for reference.

---

## Work Completed

### 1. Project Data Migration to BigQuery

**Target:** `aialgotradehits.kaamyabpakistan_data.projects`

**Data Sources Used:**
1. `kaamyab-projects-database.json` - 240 projects (serial 1-240)
2. `projects_401_512.csv` - 67 projects (serial 410-512 with gaps)
3. `kaamyab-combined-csv.txt` - 107 additional projects
4. `kaamyab-missing-projects.txt` - 173 missing projects (generated by Claude.ai)

**Final Result:** 512 projects loaded successfully

**Categories (15 total):**
- Agriculture, BioTech, Business, Chemical, Construction
- Electronics, Energy, Food, Garments, Herbals
- IT, Legal, Mechanical, Media, Tourism

### 2. Scripts Created

#### `load_all_kaamyab_projects.py`
- Combines data from multiple CSV sources
- Creates projects table with proper schema
- Loads 339 initial projects
- Updates categories table

#### `add_missing_kaamyab_projects.py`
- Adds the 173 missing projects (serial 196, 241-406, 433-438)
- Checks for duplicates before inserting
- Updates categories with new counts
- Verifies all 512 projects loaded

### 3. Old Source Code Extracted

**Location:** `kaamyabpakistan_app/old_source/kaamyabpakistan-master/`

Extracted from `kaamyabpakistan-master.zip`

---

## Old Project Architecture

### Tech Stack
- **Frontend:** React (create-react-app)
- **Backend:** Node.js + Express
- **Database:** PostgreSQL (Cloud SQL)
- **Storage:** Google Cloud Storage (`kp_uploads` bucket)
- **UI Library:** Ant Design (antd)
- **Routing:** React Router

### Project Structure

```
kaamyabpakistan-master/
├── server.js                 # Express server (port 8080)
├── package.json
├── Dockerfile
├── .env
├── molten-optics-310919-77884105ae64.json  # GCP credentials
├── app/
│   ├── config/
│   │   ├── db.config.js           # PostgreSQL config
│   │   ├── google.cloud.storage.js
│   │   └── bucket.access.js
│   ├── controllers/
│   │   ├── project.controller.js   # Main/Sub projects CRUD
│   │   ├── user.controller.js
│   │   ├── bigQueryUser.js
│   │   ├── subProject.blog.Controller.js
│   │   ├── subProject.video.Controller.js
│   │   ├── FinanceController/
│   │   ├── FranchiseeController/
│   │   ├── FranchiserController/
│   │   ├── InventorControllers/
│   │   ├── InvesterController/
│   │   ├── GDP/
│   │   ├── Projects/
│   │   └── SBP/
│   ├── models/
│   │   ├── project.model.js        # Main projects table
│   │   ├── projectItem.model.js    # Sub-projects table
│   │   ├── sublistDes.model.js     # Project descriptions
│   │   ├── subProjectBlogs.model.js
│   │   ├── subprojectvideo.model.js
│   │   ├── finance.model.js
│   │   ├── mentor.model.js
│   │   ├── user.model.js
│   │   └── InvesterModels/
│   ├── routers/
│   │   ├── index.js
│   │   ├── router.js
│   │   ├── mainProject.js
│   │   ├── investor.router.js
│   │   ├── inventors.js
│   │   ├── franchisee.js
│   │   ├── franchiser.js
│   │   ├── finance.js
│   │   ├── sbp.js
│   │   ├── gdp.js
│   │   └── cloud.storage.router.js
│   └── helpers/
│       ├── index.js
│       ├── project.uploader.js
│       └── subProjectVideo.uploader.js
└── client/
    ├── package.json
    ├── public/
    │   ├── index.html
    │   └── manifest.json
    └── src/
        ├── App.js
        ├── App.css
        ├── index.js
        ├── index.css
        ├── config/
        │   ├── routes.jsx
        │   ├── path.jsx
        │   └── 404.js
        ├── assets/
        │   └── header/homeGraphic.png
        ├── components/
        │   ├── Navabr/
        │   ├── Footer/
        │   ├── Dashboard/
        │   ├── SubProjects/
        │   ├── BreadCrumbs/
        │   ├── SBPComp/
        │   ├── Franchisee/
        │   ├── Franchiser/
        │   ├── Inventors/
        │   ├── Investors/
        │   ├── BankFinance/
        │   ├── MushariqaDes/
        │   ├── Exports/
        │   ├── Imports/
        │   ├── Header/
        │   └── ReadMore/
        ├── screens/
        │   ├── Home/
        │   ├── HomeNew/
        │   ├── DashBoard/
        │   ├── Finance/
        │   ├── Franchisee/
        │   ├── Franchiser/
        │   ├── Inventors/
        │   ├── Investors/
        │   ├── LoginSignup/
        │   ├── Profile/
        │   ├── ContactUs/
        │   └── SBP/
        └── utils/
```

### Navigation Structure (Old Site)

| Route | Screen | Description |
|-------|--------|-------------|
| `/` | HomeNew | Landing page with hero section |
| `/Projects` | Home | Grid of main project categories |
| `/:project_id` | SubProjects | Sub-projects under a category |
| `/:project_id/:sub_id` | MushariqaDes | Project details with tabs |
| `/investors` | Investors | Investor information |
| `/inventors` | Inventors | Inventor information |
| `/franchiser` | Franchiser | Franchiser section |
| `/franchisee` | Franchisee | Franchisee section |
| `/sbp` | SBP | State Bank of Pakistan data |
| `/finance` | BankFinance | Bank finance information |
| `/contactUs` | ContactUs | Contact form |
| `/signin` | SignIn | Login page |
| `/signup` | Signup | Registration page |
| `/profile` | Profile | User profile |
| `/dashboard` | Dashboard | Admin dashboard |

### API Endpoints (Old Backend)

**Main Projects:**
- `GET /api/get/all/mainprojects` - Get all main project categories
- `GET /api/get/project/:project_id` - Get project by ID
- `POST /api/create/mainproject` - Create new project
- `PUT /api/update/mainproject` - Update project
- `DELETE /api/delete/mainproject/:project_id` - Delete project

**Sub-Projects:**
- `GET /api/get/subproject/:project_id` - Get sub-projects by parent
- `GET /api/get/subpro/:sub_id` - Get sub-project by ID
- `POST /api/create/subproject` - Create sub-project
- `PUT /api/update/subproject` - Update sub-project
- `DELETE /api/delete/subproject/:sub_id` - Delete sub-project

**Sub-Project Descriptions:**
- `GET /api/get/subprojectdes/:sub_id` - Get description
- `POST /api/create/subprojectdes` - Create description
- `PUT /api/update/subprojectdes` - Update description
- `DELETE /api/delete/subprojectdes/:id` - Delete description

**Other Routes:**
- `/api/investor/*` - Investor management
- `/api/inventor/*` - Inventor management
- `/api/franchiser/*` - Franchiser management
- `/api/franchisee/*` - Franchisee management
- `/api/finance/*` - Finance data
- `/api/sbp/*` - SBP imports/exports data
- `/api/gdp/*` - GDP sectors data
- `/uploads` - File upload to GCS

### Database Schema (Old - PostgreSQL)

**projects table:**
```
project_id (PK)
title
img_url
edited_by
edited_date
is_deleted
```

**projectItems table (sub-projects):**
```
sub_id (PK)
project_id (FK)
title
img_url
edited_by
edited_date
is_deleted
```

**sublistDes table (descriptions):**
```
id (PK)
sub_id (FK)
franchise
type
members
foreign_jobs
domestic_jobs
export_market_size
domestic_market_rs
problem_statement
description
people_impact
financial_impact
edited_by
edited_date
is_deleted
```

### UI Design Elements (Old Site)

**Color Scheme:**
- Primary Green: `#006400` (dark green)
- Button Green: `#006822`
- Hover Green: `#228b22`
- Background: `#fefefe`
- Border: `lightgray`

**Fonts:**
- Default: sans-serif

**Layout:**
- Navbar: Logo on left, horizontal menu on right
- Home: Two-column layout (text left, graphic right)
- Projects: Grid of 200x180px cards with images
- Cards: Shadow effect, gray background for titles

**Key CSS Classes:**
- `.container-home` - Main container
- `.wave-header` - Header with logo
- `.navigations` - Horizontal menu
- `.projects-div` - Flex grid for projects
- `.main-card-projects` - Individual project cards
- `.button` - Green CTA buttons

### Project Detail View (MushariqaDes)

The project detail page uses Ant Design Tabs with 3 sections:
1. **Project Videos** - Video content for the project
2. **Project Blogs** - Blog posts about the project
3. **Project Details** - Detailed information fields:
   - Project name (franchise)
   - Type
   - Members
   - Foreign Jobs
   - Domestic Jobs
   - Export Market Size
   - Domestic Market Size
   - Problem Statement
   - Description
   - People Impact
   - Financial Impact

### Assets Location

- Logo: `client/src/assets/kplogonew.jpeg`
- Home graphic: `client/src/assets/header/homeGraphic.png`
- Uploads bucket: `gs://kp_uploads`

---

## Current Implementation vs Old Site

| Feature | Old Site | Current (index.html) |
|---------|----------|---------------------|
| Framework | React SPA | Static HTML |
| Backend | Node.js + Express | Flask + Vertex AI |
| Database | PostgreSQL (Cloud SQL) | BigQuery |
| Storage | GCS (`kp_uploads`) | BigQuery |
| UI Library | Ant Design | Custom CSS |
| AI Chat | None | Gemini AI integrated |
| Loan Calculator | None | Yes (interest-free) |
| Color | #006400 green | #01411C green |
| Project Structure | Categories > Sub-projects > Details | Flat list with categories |

---

## To Conform to Old Site Design

### Phase 1: Frontend Restructure
1. Convert from static HTML to React app
2. Use Ant Design component library
3. Implement same navigation structure
4. Match color scheme (#006400, #006822)
5. Use same card layout (200x180px)

### Phase 2: Data Structure
1. Split projects into Main Categories + Sub-Projects
2. Add sub-project descriptions table
3. Migrate existing 512 projects to new structure:
   - Main projects = Categories (15)
   - Sub-projects = Individual projects (512)

### Phase 3: Backend API
1. Create Node.js/Express backend OR
2. Update Flask backend to match old API structure
3. Implement same CRUD endpoints

### Phase 4: Additional Features
1. Add Investor/Inventor sections
2. Add Franchiser/Franchisee sections
3. Add SBP imports/exports data
4. Add GDP sectors data
5. Add user authentication (login/signup)
6. Add admin dashboard

---

## GCP Projects Reference

| Project ID | Name | Project Number | Purpose |
|------------|------|----------------|---------|
| molten-optics-310919 | KaamyabPakistan | 521451186007 | Old site (active) |
| aialgotradehits | aialgotradehits | 1075463475276 | New migration target |

### Old Project Resources
- Cloud Run: `kaamyabpakistan-521451186007.us-east1.run.app`
- Cloud SQL: `molten-optics-310919:us-east1:kaamyabpakistan`
- GCS Bucket: `kp_uploads`
- Domain: `kaamyabpakistan.org` (redirects to Cloud Run)

---

## Files Reference

### Data Files
- `kaamyabpakistan_app/kaamyab-projects-database.json` - 240 projects
- `kaamyabpakistan_app/projects_001_240.csv` - Projects 1-240
- `kaamyabpakistan_app/projects_401_512.csv` - Projects 401-512
- `kaamyabpakistan_app/kaamyab-combined-csv.txt` - Combined data
- `kaamyabpakistan_app/kaamyab-missing-projects.txt` - Missing 173

### Old Source Code
- `kaamyabpakistan_app/old_source/kaamyabpakistan-master/` - Full project

### Current Implementation
- `kaamyabpakistan_app/index.html` - Current frontend
- `kaamyabpakistan_app/backend/main.py` - Current Flask API
- `kaamyabpakistan_app/Dockerfile` - Container config

### Scripts
- `load_all_kaamyab_projects.py` - Initial data load
- `add_missing_kaamyab_projects.py` - Add missing projects

---

## Session Commands Reference

```bash
# Extract old source
powershell -Command "Expand-Archive -Path 'kaamyabpakistan_app/kaamyabpakistan-master.zip' -DestinationPath 'kaamyabpakistan_app/old_source' -Force"

# Run project loader
python load_all_kaamyab_projects.py

# Add missing projects
python add_missing_kaamyab_projects.py

# Verify data in BigQuery
bq query --project_id=aialgotradehits "SELECT COUNT(*) FROM kaamyabpakistan_data.projects"

# List old project services
gcloud run services list --project=molten-optics-310919 --region=us-east1
```

---

## Next Steps (When Resuming)

1. **Option A: Keep Flask + Add React Frontend**
   - Build React frontend matching old design
   - Keep Flask backend with Gemini AI
   - Connect React to Flask API

2. **Option B: Full Migration to Old Stack**
   - Use old Node.js/Express codebase
   - Update to use BigQuery instead of PostgreSQL
   - Deploy to Cloud Run on `aialgotradehits`

3. **Data Migration**
   - Convert flat 512 projects to hierarchical structure
   - Create main categories table
   - Create sub-projects table
   - Link to descriptions

---

*Work record created: December 12, 2025*
*Old source code location: `kaamyabpakistan_app/old_source/kaamyabpakistan-master/`*
